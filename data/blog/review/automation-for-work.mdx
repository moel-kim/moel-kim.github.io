---
title: "[후기] 현업에서 써먹는 자동화"
date: 2024-08-04
tags:
  - review
  - automation
draft: false
summary: 생산성 향상을 위해 했던 고민들
images:
  - https://cdn.prod.website-files.com/5f23ea6573efdd34e5776065/636e1f4daaa7ec2581239cdf_Test%20Automation%20requires%20coding%20skill%2C%20discuss.jpg
layout: PostLayout
---

<TOCInline toc={props.toc} exclude={'Intro'} asDisclosure />

## Intro

들어가기에 앞서, 아래의 내용은 `동아리에서 진행했던 발표내용을 정리한 내용`임을 밝힙니다.

관련 내용: [현업에서 써먹는 자동화](https://www.youtube.com/watch?v=rnrJNeuhQC8), [발표 자료](https://d.pr/f/MzUwHq)

오늘은 `현업에서 써먹는 자동화`란 주제로 글을 쓰려고 합니다.

글을 시작하기에 앞서 생산성이라는 주제로 간략하게 이야기를 시작해보려 합니다.

생산성이란 무엇일까요? 

생산성이란

>주어진 자원(시간, 노력, 비용 등)을 활용해 얼마나 많은 성과나 결과를 효과적으로 창출할 수 있는지를 나타내는 개념입니다. 정확한 정의는 [생산성](https://ko.wikipedia.org/wiki/%EC%83%9D%EC%82%B0%EC%84%B1) 을 참고해주세요

그럼 프로그래머 관점으로 치환보면

> 주어진 시간 내에 호율적으로 고품질의 소프트웨어를 개발하고 유지보수할 수 있는 능력이라고 볼 수 있습니다.

가장 중요한 부분이 `주어진 시간 내`라고 생각합니다. 하지만 아무것도 없는 환경에서 `주어진 시간 내`라는 요소와 `고품질`이라는 두 요소를 챙기는 것은 불가능합니다.

또한 `개발` 뿐만이 아니라 `유지보수`가 용이한 코드를 챙기는 것은 일반적으로 시간이 많이 드는 작업입니다.

위에서 제시한 세 가지 요소(기한, 고품질, 유지보수)를 모두 챙기려면 어떻게 해야할까요?

제가 생각하는 가장 좋은 방법은 `자동화` 입니다. 특히 `반복되는 실수`를 방지하고 구성원이 `개발에만 집중할 수 있는 환경`을 조성하는 자동화가 중요하다고 생각하는데요

오늘은 지난 11개월 동안 진행했던 자동화에 대해서 이야기해보려고 합니다.

## 자동화

### 자동화의 정의

프로그래밍 영역에서 자동화란

> 반복적이거나 수동적인 작업을 사람이 직접 수행하지 않고, 소프트웨어나 도구를 통해 자동으로 처리하는 프로세스

을 의미합니다.

이를 통해 효율성을 높이고, 오류를 줄이며, 개발자들이 더 중요한 창의적인 작업에 집중할 수 있도록 돕습니다.

무엇보다 `실패했지만 실패가 반복되지 않는 환경`을 만들 수 있습니다.


### 자동화하는 이유

우선 대표적인 두가지가 있습니다.

`개발 경험 일관화`와 `개발 효율성이 향상`이 있습니다.

이해하기 쉽도록 식당 주문 API를 만들어보면서 알아봅시다

우선 API Spec을 관리를 어떻게 할지 선택할 때, 다음과 같은 선택지가 있습니다

* Excel
* Swagger
* Git Book
* etc..(Redocly, Slate, ..)

이 때 한 개발자는 API가 많지 않을거라 예상해, Excel을 이용해서 API Spec을 관리하기로 결심했습니다.

해당 개발자가 정리한 식당 주문 API의 Spec은 다음과 같습니다

![order](https://d.pr/i/GvcZ7I.png)

Excel을 통해 API를 만들어도 프로그램을 제작하는데 문제는 없습니다.

하지만 현재는 거의 쓰지 않는 방식인데요, 이유는 다음과 같습니다

- 변경에 취약하다. 
	- API Endpoint나 Parameter, Request, Response의 field 이름이 바뀌면, 타입 시스템을 통해 변경을 감지할 수 없다
- 실제 구현과 문서과 분리되어 있어 문서 관리에 어려움이 생긴다
- 수시로 변화하는 비지니스에 안정적으로 대응하기 어렵다
- **결과적으로 돈을 벌기 어려운 구조**를 가진다

즉, `가치를 창출해야하는 개발자`의 입장에서 위의 Excel 방식은 단점이 너무 많아보입니다.

그럼 위의 단점을 개선하기 이전에, 어떤 점이 개선될 수 있는지 정리하면 다음과 같습니다

- 변경이 되면 Type 레벨에서 변경을 감지할 수 있으면 좋겠다
- Frontend, Backend를 위한 변경 감지 Plugin이 있고, 나아가 Testing 자동화도 되면 좋겠다
- (옵션) Spec이 정의된 보편적으로 사용되는 Protocol이 있고, 관련된 Parser도 있으면 좋겠다

위의 요구사항이 반영된 무언가가 있다면, 비니지스 요구사항이 추가되거나 프로그래머의 `실수가 발생해도 빠르게 대응`이 가능할 것 같습니다.

또한 `Build Test Automation, API Test Automation 등이 가능`하여 개발자의 생산성을 높여줄 수 있을 것 같습니다

사실 위의 개선 사항은, `OpenAPI Spec`을 통해 나름 보편적인 `Protocol, Parser가 제작`되어서 널리 사용되고 있습니다.

다시 한 번 정리하자면, 자동화하는 이유는 다음과 같습니다

1. `관심을 가져야하는 곳에만 집중`하도록 환경을 조성한다
2. 이를 통해 `가치를 만들어내기 쉬운 구조`를 가진다


### 왜 자동화하는가?

자동화가 중요한 이유는 다음과 같습니다

- 동료의 개발경험(DX) 향상
	- (무언가를) 자동 생성하여, 빠른 개발 프로세스 수립
- 개발 일관성
	- (무언가를) 추가할 때, 자동으로 네이밍 및 일관된 방식으로 함
	- 자동으로 추측 가능성 향상을 통한 `의사 소통 비용 절감`
		- 의사 소통 비용 절감
- 기능 확장 비용 절감

위의 API Spec 예시처럼, Spec을 합의된 Protocol로 정의할 수 있다면 동료의 개발 경험을 향상시킬 수 있습니다.

예를 들면 `API Spec을 자동으로 생성`하여, 기존에 없던 FE/BE 개발자간 빠른 개발 프로세스를 수립할 수 있습니다.

추가적으로 자동으로 API 함수의 네이밍을 결정해주거나, API Spec을 추가하는 함수를 제공하여 일관된 방식으로 API를 추가할 수 있으며

결과적으로 API Spec을 추가할때 `API 추가가 부담스럽지 않은 경험`을 제공할 수 있습니다


### 자동화의 종류

자동화의 종류를 3가지로 분류했습니다.

1. **도입** **비용이** **무한히** **낮고**, 당장 도움이 되는 자동화
2. **도입** **비용이** **많이** **들지만**, 미래에는 도움이 되는 자동화
3. 상황에 따라 적용해야하는 자동화

예를 들면 첫번째 경우는 OpenAPI Spec을 이용해 Mockup 서버를 자동으로 생성하는 경우가 있습니다.

두번째 경우는 주로 새로운 라이브러리나 개발 프로세스를 도입하는 걸 예로 들 수 있으며

마지막은 문화적 관점(Pull Request Title Check)에서 시도할 수 있는 자동화들이 있었습니다. 주로 회사의 규모, 구성원들의 성향에 따라 도입 여부가 결정되는 것들이 많았어요.

오늘은 위의 3가지 관점에서 도입할 수 있는 자동화를 소개하겠습니다.


## 1. **도입** **비용이** **낮은** 자동화

### Mock Server AutoGen(with. OpenAPI)

### 용어 정리

`OpenAPI`: 
* 정의: RESTful API를 정의하고 문서화기 위한 표준 포맷입니다.
* 관련 정보:
	* OpenAPI Initiative에 의해 관리됩니다
	* API의 엔드포인트, HTTP 메소드, 요청/응답 구조 등을 기술한 **기계가 읽을 수 있는 문서**로 만들 수 있습니다
	* 이를 통해 개발자 간의 협업을 용이하게 합니다
	* `기계가 읽을 수 있기 때문에` 관련 Parser를 만들 수 있고, 이를 통해 API 테스팅, 문서 생성, 코드 생성 등의 자동화가 가능합니다

`Mock Server`:
* 정의: 실제 서버 없이도 API 요청에 대한 응답을 테스트할 수 있는 가상의 서버
* 주로 다음과 같은 상황에서 사용됩니다
	* API 개발을 완료하지 않은 상태에서 Client가 API와 상호작용하는 방식을 미리 테스트
	* 외부 서비스에 의존하지 않고 독립적으로 기능 구현이 필요한 경우


#### 문제 파악 및 해결하려는 문제

현재 재직중인 팀에는 다음과 같은 2가지 문제가 있었습니다

1. API Spec만 정의되고 구현이 안된 API를 Client 코드에 반영시, UI를 테스트하기 어려워진다
	1. 해당 API는 항상 Unimplemented에러를 표시하기 때문입니다.
2. 특정 Backend 프로젝트의 경우, Cloud에 배포되어야만 API 테스팅이 가능하다
	1. 복잡한 Configuration 및 Proxy Setting으로 인해 Local에 띄울 수 없었기 때문입니다
	2. 따라서 UI만 변경해도, UI 테스팅을 위해 최소 20분의 배포 시간이 소요됩니다

#### 제작 과정

우선 Mock Server를 만들어서 해결하려 했습니다.

하지만 Mock Server를 제작하는데 다음과 같은 제약이 있었습니다.

1. 현재 팀의 Frontend 개발 리소스가 이미 한계에 도달했다
2. Mock Server를 제작하면 API Spec 변경에 대응해야한다.
3. 대응이 불가능한 시점이 온다. 따라서 아무도 안쓰는 시점이 올 것이다

따라서 좀 더 좋은 해결책이 필요했고, `Mockup 서버 생성 자동화`를 도입하게 되었습니다.

자동화가 가능하다고 생각했던 이유는 다음과 같았습니다

1. OpenAPI는 **기계가 읽을 수 있는 문서**이다
2. 따라서 Parser가 존재할 것이다
3. Parser와 Dummy Data 생성 Lirary를 조합하면 자동화가 가능할 것이다

그래서 [npm-swagger](https://www.npmjs.com/package/swagger) 패키지를 리서치 하던 중 우연히 [msw-auto-mock](https://github.com/zoubingwu/msw-auto-mock) 라는 패키지를 찾게 되어 비교적 쉽게 Mock Autogen 기능을 도입할 수 있었습니다.

만약 도입이 필요하신 분은 [Use OpenAPI to auto-generate client side code and MSW mocks](https://medium.com/@fahad.a.arsal/use-openapi-to-auto-generate-client-side-code-and-msw-mocks-bea7215d88db) 글을 읽어보시기 바랍니다.

#### 좋았던 점 

우선 가장 좋았던 점은 UI 테스팅에 더 이상 `Backend 서비스를 실행하지 않아도 되는 점`이 좋았습니다.

그리고 API Spec만 있으면 Backend 개발자와 함께 동시적으로 개발이 가능한 점이 좋았습니다

#### 아쉬운 점

자동 생성된 Mock 데이터가 적절하지 않은 경우가 종종 있었습니다.

예를 들면 원하는 데이터가 Image URL 데이터 임에도 일반적인 string 데이터가 내려와 `<Image />` 컴포넌트가 제대로 동작하지 않는 문제가 있었습니다.

현재 해당 문제를  [msw-auto-mock](https://github.com/zoubingwu/msw-auto-mock) 패키지에서 `생성형 AI`를 통해 개선하는 작업사항이 있습니다. 이를 곧 회사 프로젝트에 적용하려고 준비중입니다.


## 2. **도입** **비용이** **높은** 자동화(실제 도입하지 않음)

실제 아래에 있는 자동화는 도입하지 않았습니다. 

왜냐하면 현재 진행중인 프로젝트 특성상 디자인 시스템을 필요로 하지 않았기 때문입니다.

### Design Token, SVG AutoGen(With. Figma Token)

### 용어 정리

`Design Token`: 
* 정의: 디자인 시스템에서 `색상, 글꼴 크기, 간격, 그림자, 테마` 등과 같은 디자인 속성을 코드로 변환하여 일관된 스타일을 유지하고, 다양한 플랫폼에서 재사용할 수 있게 하는 표준화된 값

`SVG`:
* 정의: **확장 가능한 벡터 그래픽스**를 의미하는 XML 기반의 그래픽 형식
* 주로 Icon으로 자주 사용되며, 동적으로 속성(크기, 색상 등)을 바꿔야하는 이미지에 사용됩니다. 


#### 문제 파악 및 해결하려는 문제

프론트엔드 개발자가 디자인 시스템을 설계할 때 겪는 가장 큰 문제는 다음과 같습니다.

1. 디자이너가 원하는 Design Token 변경에 대응하기 어렵다
	1. 또한 Tailwindcss, emotion, vanilla-extract 등 여러개의 css preprocessor를 사용하는데, 이에 맞춰 design token을 전부 제작하는건 어렵다
2. SVG를 React Component처럼 사용하기 어렵다
	1. SVG 파일을 React Component화 하면 되지만, 모든 SVG 파일에 대해서 일일히 변환하기 어렵고 시간이 많이 소요된다

#### 해결하는 방법

##### 1. Figma Token과 Style Dictionary 사용하기

1번 문제는 Figma Token과 Style Dictionary를 사용하면 됩니다


## 3. **상황**에 따라 적용해야하는 자동화

### PR title/label checker(With. Github Action)

### 용어 정리

`OpenAPI`: 
* 정의: RESTful API를 정의하고 문서화기 위한 표준 포맷입니다.
* 관련 정보:
	* OpenAPI Initiative에 의해 관리됩니다

#### 문제 파악 및 해결하려는 문제


#### 제작 과정


#### 좋았던 점 


#### 아쉬운 점




## 도입하고 싶은 자동화

앞으로 도입하고 싶은 2개의 자동화가 있습니다

하나는 UI를 자동으로 생성해주는 서비스인 [v0](https://v0.dev)입니다.

나머지 하나는 API Testing 자동화인 [Cats](https://github.com/Endava/cats)입니다.



## 후기

오늘 소개해드린 자동화는 현업에서 필자가 설득 및 DRI(Directly Responsible Individual)를 가지고 진행했던 자동화입니다.

모두 상황과 문맥에 맞게 도입하려고 했지만, 돌이켜보면 그렇지 않은 자동화도 상당히 있었습니다.

또한 같은 자동화임에도, 